<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://ibm-mas.github.io/ansible-devops/roles/cp4d_db2wh_api/">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Cp4d db2wh api - MAS Devops Collection</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  <link href="../../extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Cp4d db2wh api";
    var mkdocs_page_input_path = "roles/cp4d_db2wh_api.md";
    var mkdocs_page_url = "/ansible-devops/roles/cp4d_db2wh_api/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> MAS Devops Collection</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Full Stack Playbooks</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/fullstack-roks/">IBM Cloud</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Lite Playbooks</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/lite-core-roks/">Core only on IBM Cloud</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/lite-core-quickburn/">Core only on QuickBurn</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/lite-health-roks/">Health on IBM Cloud</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/lite-manage-roks/">Manage on IBM Cloud</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Other Playbooks</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/ocp/">OCP Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/dependencies/">Dependencies Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/cp4d/">CP4D Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/mas/">MAS Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/sls/">SLS Playbook</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/bas/">BAS Playbook</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Roles</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../airgap_install_case/">airgap_install_case</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../airgap_mirror_case/">airgap_mirror_case</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../airgap_prepare_case/">airgap_prepare_case</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../amqstreams/">amqstreams</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../bas_install/">bas_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_db2wh/">cp4d_db2wh</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_db2wh_manage_hack/">cp4d_db2wh_manage_hack</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_install/">cp4d_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_install_services/">cp4d_install_services</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../fvt_simulate_airgap/">fvt_simulate_airgap</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../install_operator/">install_operator</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../mongodb/">mongodb</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_deprovision/">ocp_deprovision</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_login/">ocp_login</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_provision/">ocp_provision</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_setup_github_oauth/">ocp_setup_github_oauth</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_setup_mas_deps/">ocp_setup_mas_deps</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_setup_ocs/">ocp_setup_ocs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../sls_install/">sls_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_app_configure/">suite_app_configure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_app_install/">suite_app_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_config/">suite_config</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_dns/">suite_dns</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_install/">suite_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_verify/">suite_verify</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">MAS Devops Collection</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
    
    <li>Cp4d db2wh api</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/ibm-mas/ansible-devops/blob/master/docs/roles/cp4d_db2wh_api.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="cp4d_db2wh_api">cp4d_db2wh_api<a class="headerlink" href="#cp4d_db2wh_api" title="Permanent link"></a></h1>
<p>This role expects a CP4D with DB2 Warehouse service enabled already exists. Use it after <code>install-cp4d</code>.</p>
<p>It can be used to create DB2 Warehouse instances against the same Cloud Pak for Data. It is useful if user wants to create a database for IoT and another for Manage. In additional, different from other DB2 Warehouse playbooks, this one uses REST APIs and not Operators to create the DB2 instance (operators are not working properly in CP4D 3.5). By using REST APIs internally, we have a bit more configuration possibilties here as well as the instance will be displayed in CP4D dashboard.</p>
<h2 id="role-variables">Role Variables<a class="headerlink" href="#role-variables" title="Permanent link"></a></h2>
<h3 id="required-variables">Required Variables<a class="headerlink" href="#required-variables" title="Permanent link"></a></h3>
<ul>
<li><code>CPD_DB2WH_INSTANCE_NAME</code> Name of your database instance, visible in CP4D dashboard. Example: <code>db2w-iot</code></li>
<li><code>CPD_ENTITLEMENT_KEY</code> An <a href="https://myibm.ibm.com/products-services/containerlibrary">IBM entitlement key</a> that includes access to Cloud Pak for Data 3.5.0</li>
<li><code>CPD_NAMESPACE</code> Provide the namespace where Cloud Pak for Data is installed. CP4D playbooks create it, by default, in <code>cpd-meta-ops</code></li>
<li><code>MAS_INSTANCE_ID</code> Provide the MAS instance ID that will be used in any generated MAS configuration files</li>
<li><code>MAS_CONFIG</code> Provide the path of the folder where the JDBCCfg yaml containing the credentials of this database will be saved at the end of the process.</li>
</ul>
<h3 id="optional-variables">Optional Variables<a class="headerlink" href="#optional-variables" title="Permanent link"></a></h3>
<p>In addition to the above, these are the optional variables you can set before running the playbook:</p>
<ul>
<li><code>CPD_META_STORAGE_SIZE_GB</code> size of configuration persistent volume, in gigabytes. Default is <code>20</code></li>
<li><code>CPD_USER_STORAGE_SIZE_GB</code> size of user persistent volume, in gigabytes. Default is <code>100</code></li>
<li><code>CPD_BACKUP_STORAGE_SIZE_GB</code> size of backup persistent volume, in gigabytes. Default is <code>100</code></li>
<li><code>CPD_META_STORAGE_CLASS</code> store class used to create the configuration storage. Default is <code>ibmc-file-silver-gid</code></li>
<li><code>CPD_USER_STORAGE_CLASS</code> store class used to create the user storage. Default is <code>ibmc-file-gold-gid</code></li>
<li><code>CPD_BACKUP_STORAGE_CLASS</code> store class used to create the backup storage. Default is <code>ibmc-file-gold-gid</code></li>
<li><code>CPD_ADMIN_USER</code> user in CP4D that can access the database. The user must exist, it is not created by this playbook. Default is <code>admin</code></li>
<li><code>CPD_ADMIN_PASSWORD</code> password of the user identified above. Default is <code>password</code></li>
<li><code>CPD_DB2WH_ADDON_VERSION</code> version of the DB2 Warehouse instance to be creared. Default is <code>11.5.5.1-cn3-x86_64</code></li>
<li><code>DB2WH_TABLE_ORG</code> the way database tables will be organized. It can be either <code>ROW</code> or <code>COLUMN</code>. Default is <code>ROW</code></li>
</ul>
<h2 id="example-playbook">Example Playbook<a class="headerlink" href="#example-playbook" title="Permanent link"></a></h2>
<pre><code class="language-yaml">- hosts: localhost
  any_errors_fatal: true
  vars:
    # DB2W-API settings
    cpd_meta_namespace: &quot;{{ lookup('env', 'CPD_NAMESPACE') | default('cpd-meta-ops', true) }}&quot;
    cp4d_db2wh_instance_name: &quot;{{ lookup('env', 'CPD_DB2WH_INSTANCE_NAME') }}&quot; # e.g. db2w-iot or db2w-manage
    cp4d_meta_storage_size_gb: &quot;{{ lookup('env', 'CPD_META_STORAGE_SIZE_GB') | default(20, true) }}&quot;
    cp4d_user_storage_size_gb: &quot;{{ lookup('env', 'CPD_USER_STORAGE_SIZE_GB') | default(100, true) }}&quot;
    cp4d_backup_storage_size_gb: &quot;{{ lookup('env', 'CPD_BACKUP_STORAGE_SIZE_GB') | default(100, true) }}&quot;
    cp4d_meta_storage_class: &quot;{{ lookup('env', 'CPD_META_STORAGE_CLASS') | default('ibmc-file-silver-gid', true) }}&quot;
    cp4d_user_storage_class: &quot;{{ lookup('env', 'CPD_USER_STORAGE_CLASS') | default('ibmc-file-gold-gid', true)  }}&quot;
    cp4d_backup_storage_class: &quot;{{ lookup('env', 'CPD_BACKUP_STORAGE_CLASS') | default('ibmc-file-gold-gid', true)  }}&quot;
    cp4d_admin_username: &quot;{{ lookup('env', 'CPD_ADMIN_USER')  | default('admin', true) }}&quot;
    cp4d_admin_password: &quot;{{ lookup('env', 'CPD_ADMIN_PASSWORD')  | default('password', true) }}&quot;
    cp4d_db2_addon_version: &quot;{{ lookup('env', 'CPD_DB2WH_ADDON_VERSION') | default('11.5.5.1-cn3-x86_64', true) }}&quot;
    db2w_table_org: &quot;{{ lookup('env', 'DB2WH_TABLE_ORG') | default('ROW', true) }}&quot; # e.g ROW or COLUMN
    # Create the MAS JdbcCfg &amp; Secret resource definitions
    mas_instance_id: &quot;{{ lookup('env', 'MAS_INSTANCE_ID') }}&quot;
    mas_config_dir: &quot;{{ lookup('env', 'MAS_CONFIG_DIR') }}&quot;
  roles:
    - ibm.mas_devops.cp4d_db2wh_api
</code></pre>
<h2 id="license">License<a class="headerlink" href="#license" title="Permanent link"></a></h2>
<p>EPL-2.0</p>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ibm-mas/ansible-devops/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
